<section class="projects-section py-5" [class.bg-light]="!isDarkTheme" [class.bg-dark]="isDarkTheme">
  <div class="container">

    <!-- Add Project Form (Edit Mode) -->
    <div *ngIf="isEditMode && activeTab === 'projects'" class="add-project-form mb-5">
      <div class="card glass-card">
        <div class="card-header">
          <h5 class="card-title mb-0">Add New Project</h5>
        </div>
        <div class="card-body">
          <div class="row g-3">
            <div class="col-md-6">
              <input
                type="text"
                class="form-control"
                placeholder="Project Title"
                [(ngModel)]="newProject.title"
              />
            </div>
            <div class="col-md-6">
              <input
                type="text"
                class="form-control"
                placeholder="Technologies (comma separated)"
                [(ngModel)]="newProject.technologies"
              />
            </div>
            <div class="col-12">
              <textarea
                class="form-control"
                placeholder="Project Description"
                [(ngModel)]="newProject.description"
                rows="3"
              ></textarea>
            </div>
            <div class="col-md-4">
              <input
                type="text"
                class="form-control"
                placeholder="Project Link"
                [(ngModel)]="newProject.link"
              />
            </div>
            <div class="col-md-4">
              <input
                type="text"
                class="form-control"
                placeholder="GitHub Link"
                [(ngModel)]="newProject.githubLink"
              />
            </div>
            <div class="col-md-4">
              <input
                type="text"
                class="form-control"
                placeholder="Animation URL (Lottie)"
                [(ngModel)]="newProject.animationUrl"
              />
            </div>
            <div class="col-12">
              <button class="btn btn-primary" (click)="addNewProject()">
                <i class="fas fa-plus me-2"></i>Add Project
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Enhanced Tabs Navigation -->
    <div class="tabs-wrapper mb-5">
      <div class="row justify-content-center">
        <div class="col-auto">
          <div class="btn-group" role="group">
            <button
              class="btn btn-tab rounded-pill mx-1 mb-2"
              [class.active]="activeTab === 'projects'"
              (click)="onTabChange('projects')"
            >
              <i class="fas fa-code me-2"></i> Projects
            </button>
            <button
              class="btn btn-tab rounded-pill mx-1 mb-2"
              [class.active]="activeTab === 'medium'"
              (click)="onTabChange('medium')"
            >
              <i class="fab fa-medium me-2"></i> Medium
            </button>
            <button
              class="btn btn-tab rounded-pill mx-1 mb-2"
              [class.active]="activeTab === 'quora'"
              (click)="onTabChange('quora')"
            >
              <i class="fab fa-quora me-2"></i> Quora
            </button>
            <button
              class="btn btn-tab rounded-pill mx-1 mb-2"
              [class.active]="activeTab === 'linkedin'"
              (click)="onTabChange('linkedin')"
            >
              <i class="fab fa-linkedin me-2"></i> LinkedIn
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Tabs Content - FIXED STRUCTURE -->
    <div class="tab-content">
      <!-- Projects Tab -->
      <div *ngIf="activeTab === 'projects'" class="tab-pane active">
        <!-- Show Cards if data exists -->
        <div *ngIf="projects.length > 0; else noProjects" class="projects-grid-container">
          <div class="row g-4">
            <div
              class="col-xl-4 col-lg-6 col-md-6 mb-4"
              *ngFor="let project of projects; let i = index"
            >
              <div class="project-card glass-card" [class.editable]="isEditMode">
                <div class="project-image">
                  <!-- Lottie Animation Container -->
                  <div
                    #lottieContainer
                    class="lottie-animation"
                    *ngIf="project.animationUrl"
                  ></div>

                  <!-- Fallback Image -->
                  <img
                    [src]="project.imageUrl"
                    [alt]="project.title"
                    class="img-fluid fallback-image"
                    *ngIf="!project.animationUrl"
                  />

                  <div class="project-overlay d-flex flex-column">
                    <h5 class="text-white mb-3">{{ project.title }}</h5>
                    <div class="mt-auto">
                      <!-- Matrix Notes - Goes to tutorials page -->
                      <a
                        *ngIf="project.title === 'Matrix Notes - Tutorial Management System'"
                        [routerLink]="['/tutorials']"
                        class="btn btn-light btn-sm me-2"
                      >
                        <i class="fas fa-external-link-alt me-1"></i>View Live
                      </a>
                      
                      <!-- Online Clipboard - Internal route -->
                      <a
                        *ngIf="project.title.includes('MatrixShare') || project.title.includes('Online Clipboard')"
                        [routerLink]="['/online-clipboard']"
                        class="btn btn-light btn-sm me-2"
                      >
                        <i class="fas fa-external-link-alt me-1"></i>View Live
                      </a>
                      
                      <!-- External links -->
                      <a
                        *ngIf="project.link && !project.link.startsWith('/') && project.title !== 'Matrix Notes - Tutorial Management System' && !project.title.includes('MatrixShare')"
                        [href]="project.link"
                        target="_blank"
                        class="btn btn-light btn-sm me-2"
                      >
                        <i class="fas fa-external-link-alt me-1"></i>View Live
                      </a>
                      
                      <!-- Other internal routes -->
                      <a
                        *ngIf="project.link && project.link.startsWith('/') && project.title !== 'Matrix Notes - Tutorial Management System' && !project.title.includes('MatrixShare')"
                        [routerLink]="project.link"
                        class="btn btn-light btn-sm me-2"
                      >
                        <i class="fas fa-external-link-alt me-1"></i>View Live
                      </a>
                      
                      <!-- GitHub Link -->
                      <a
                        [href]="project.githubLink"
                        target="_blank"
                        class="btn btn-dark btn-sm"
                        *ngIf="project.githubLink && project.githubLink !== '#'"
                      >
                        <i class="fab fa-github me-1"></i>Code
                      </a>
                    </div>
                  </div>

                  <!-- Edit Controls -->
                  <div class="edit-controls" *ngIf="isEditMode">
                    <button class="btn btn-warning btn-sm me-1">
                      <i class="fas fa-edit"></i>
                    </button>
                    <button
                      class="btn btn-danger btn-sm"
                      (click)="deleteProject(project, $event)"
                    >
                      <i class="fas fa-trash"></i>
                    </button>
                  </div>
                </div>
                <div class="project-body">
                  <div class="d-flex justify-content-between align-items-start mb-2">
                    <h5 class="project-title mb-0">{{ project.title }}</h5>
                    <span class="badge bg-primary" *ngIf="project.featured">
                      Featured
                    </span>
                  </div>
                  <p class="project-description">{{ project.description }}</p>
                  <div class="project-tech">
                    <span
                      class="tech-badge"
                      *ngFor="let tech of project.technologies"
                    >
                      <i [class]="getTechIcon(tech)"></i> {{ tech }}
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- No Data State Template -->
        <ng-template #noProjects>
          <div class="no-data-state">
            <div class="no-data-content text-center">
              <div class="no-data-animation">
                <div class="animation-placeholder projects-animation">
                  <i class="fas fa-folder-open"></i>
                </div>
              </div>
              <div class="no-data-text-content">
                <h3 class="no-data-title">No Projects Yet</h3>
                <p class="no-data-description">
                  It looks like you haven't added any projects yet. Start
                  showcasing your amazing work by adding your first project!
                </p>
                <div class="no-data-actions" *ngIf="isEditMode">
                  <button
                    class="btn btn-primary btn-lg"
                    (click)="addNewProject()"
                  >
                    <i class="fas fa-plus me-2"></i>Add Your First Project
                  </button>
                </div>
                <div class="no-data-actions" *ngIf="!isEditMode">
                  <p class="text-muted">
                    Check back later for amazing projects!
                  </p>
                </div>
              </div>
            </div>
          </div>
        </ng-template>
      </div>

      <!-- Medium Tab -->
      <div *ngIf="activeTab === 'medium'" class="tab-pane active">
        <div *ngIf="mediumPosts.length > 0; else noMedium" class="projects-grid-container">
          <div class="row g-4">
            <div
              class="col-xl-4 col-lg-6 col-md-6 mb-4"
              *ngFor="let post of mediumPosts"
            >
              <div class="project-card glass-card" [class.editable]="isEditMode">
                <div class="project-image">
                  <!-- Platform-specific background -->
                  <div class="platform-background medium-bg">
                    <i class="fab fa-medium platform-logo"></i>
                  </div>

                  <div class="project-overlay d-flex flex-column">
                    <h5 class="text-white mb-3">{{ post.title }}</h5>
                    <div class="mt-auto">
                      <a
                        [href]="post.link"
                        target="_blank"
                        class="btn btn-light btn-sm"
                      >
                        <i class="fas fa-external-link-alt me-1"></i>Read
                        Article
                      </a>
                    </div>
                  </div>
                </div>
                <div class="project-body">
                  <div class="d-flex justify-content-between align-items-start mb-2">
                    <h5 class="project-title mb-0">{{ post.title }}</h5>
                    <span class="badge bg-dark">
                      <i class="fab fa-medium me-1"></i> Medium
                    </span>
                  </div>
                  <p class="project-description">{{ post.description }}</p>
                  <div class="project-tech">
                    <span class="tech-badge">
                      <i class="fas fa-clock"></i> {{ post.readTime }} read
                    </span>
                    <span class="tech-badge">
                      <i class="fas fa-heart"></i> {{ post.likes }} likes
                    </span>
                    <span class="tech-badge">
                      <i class="fas fa-calendar"></i> {{ post.date }}
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- No Data State Template -->
        <ng-template #noMedium>
          <div class="no-data-state">
            <div class="no-data-content text-center">
              <div class="no-data-animation">
                <div class="animation-placeholder medium-animation">
                  <i class="fab fa-medium"></i>
                </div>
              </div>
              <div class="no-data-text-content">
                <h3 class="no-data-title">No Medium Articles</h3>
                <p class="no-data-description">
                  No articles published on Medium yet. Share your knowledge and
                  experiences with the community!
                </p>
                <div class="no-data-actions">
                  <a
                    href="https://medium.com/"
                    target="_blank"
                    class="btn btn-dark btn-lg"
                  >
                    <i class="fab fa-medium me-2"></i>Start Writing on Medium
                  </a>
                </div>
              </div>
            </div>
          </div>
        </ng-template>
      </div>

      <!-- Quora Tab -->
      <div *ngIf="activeTab === 'quora'" class="tab-pane active">
        <div *ngIf="quoraPosts.length > 0; else noQuora" class="projects-grid-container">
          <div class="row g-4">
            <div
              class="col-xl-4 col-lg-6 col-md-6 mb-4"
              *ngFor="let post of quoraPosts"
            >
              <div class="project-card glass-card" [class.editable]="isEditMode">
                <div class="project-image">
                  <div class="platform-background quora-bg">
                    <i class="fab fa-quora platform-logo"></i>
                  </div>

                  <div class="project-overlay d-flex flex-column">
                    <h5 class="text-white mb-3">{{ post.title }}</h5>
                    <div class="mt-auto">
                      <a
                        [href]="post.link"
                        target="_blank"
                        class="btn btn-light btn-sm"
                      >
                        <i class="fas fa-external-link-alt me-1"></i>View Answer
                      </a>
                    </div>
                  </div>
                </div>
                <div class="project-body">
                  <div class="d-flex justify-content-between align-items-start mb-2">
                    <h5 class="project-title mb-0">{{ post.title }}</h5>
                    <span class="badge bg-danger">
                      <i class="fab fa-quora me-1"></i> Quora
                    </span>
                  </div>
                  <p class="project-description">{{ post.description }}</p>
                  <div class="project-tech">
                    <span class="tech-badge">
                      <i class="fas fa-eye"></i> {{ post.views || '0' }} views
                    </span>
                    <span class="tech-badge">
                      <i class="fas fa-thumbs-up"></i>
                      {{ post.upvotes || '0' }} upvotes
                    </span>
                    <span class="tech-badge">
                      <i class="fas fa-calendar"></i> {{ post.date }}
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- No Data State Template -->
        <ng-template #noQuora>
          <div class="no-data-state">
            <div class="no-data-content text-center">
              <div class="no-data-animation">
                <div class="animation-placeholder quora-animation">
                  <i class="fab fa-quora"></i>
                </div>
              </div>
              <div class="no-data-text-content">
                <h3 class="no-data-title">No Quora Answers</h3>
                <p class="no-data-description">
                  No answers posted on Quora yet. Share your expertise and help
                  others by answering questions!
                </p>
                <div class="no-data-actions">
                  <a
                    href="https://www.quora.com/"
                    target="_blank"
                    class="btn btn-danger btn-lg"
                  >
                    <i class="fab fa-quora me-2"></i>Answer Questions on Quora
                  </a>
                </div>
              </div>
            </div>
          </div>
        </ng-template>
      </div>

      <!-- LinkedIn Tab -->
      <div *ngIf="activeTab === 'linkedin'" class="tab-pane active">
        <div *ngIf="linkedinPosts.length > 0; else noLinkedIn" class="projects-grid-container">
          <div class="row g-4">
            <div
              class="col-xl-4 col-lg-6 col-md-6 mb-4"
              *ngFor="let post of linkedinPosts"
            >
              <div class="project-card glass-card" [class.editable]="isEditMode">
                <div class="project-image">
                  <div class="platform-background linkedin-bg">
                    <i class="fab fa-linkedin platform-logo"></i>
                  </div>

                  <div class="project-overlay d-flex flex-column">
                    <h5 class="text-white mb-3">{{ post.title }}</h5>
                    <div class="mt-auto">
                      <a
                        [href]="post.link"
                        target="_blank"
                        class="btn btn-light btn-sm"
                      >
                        <i class="fas fa-external-link-alt me-1"></i>View Post
                      </a>
                    </div>
                  </div>
                </div>
                <div class="project-body">
                  <div class="d-flex justify-content-between align-items-start mb-2">
                    <h5 class="project-title mb-0">{{ post.title }}</h5>
                    <span class="badge bg-primary">
                      <i class="fab fa-linkedin me-1"></i> LinkedIn
                    </span>
                  </div>
                  <p class="project-description">{{ post.description }}</p>
                  <div class="project-tech">
                    <span class="tech-badge">
                      <i class="fas fa-comment"></i>
                      {{ post.comments || '0' }} comments
                    </span>
                    <span class="tech-badge">
                      <i class="fas fa-chart-line"></i>
                      {{ post.engagement || '0' }} engagement
                    </span>
                    <span class="tech-badge">
                      <i class="fas fa-calendar"></i> {{ post.date }}
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- No Data State Template -->
        <ng-template #noLinkedIn>
          <div class="no-data-state">
            <div class="no-data-content text-center">
              <div class="no-data-animation">
                <div class="animation-placeholder linkedin-animation">
                  <i class="fab fa-linkedin"></i>
                </div>
              </div>
              <div class="no-data-text-content">
                <h3 class="no-data-title">No LinkedIn Posts</h3>
                <p class="no-data-description">
                  No posts shared on LinkedIn yet. Connect with professionals
                  and share your insights with the community!
                </p>
                <div class="no-data-actions">
                  <a
                    href="https://www.linkedin.com/"
                    target="_blank"
                    class="btn btn-primary btn-lg"
                  >
                    <i class="fab fa-linkedin me-2"></i>Share on LinkedIn
                  </a>
                </div>
              </div>
            </div>
          </div>
        </ng-template>
      </div>
    </div>

    <!-- Admin Matrix Notes Access Button -->
    <div *ngIf="isEditMode" class="text-center mt-5">
      <div class="card glass-card">
        <div class="card-body">
          <h5 class="card-title">
            <i class="fas fa-book me-2"></i>Matrix Notes Admin
          </h5>
          <p class="card-text text-muted">
            As an admin, you can manage tutorials and educational content in the Matrix Notes system.
          </p>
          <div class="btn-group">
            <a [routerLink]="['/admin/matrix-notes']" class="btn btn-primary">
              <i class="fas fa-tachometer-alt me-2"></i>Matrix Notes Dashboard
            </a>
            <a [routerLink]="['/admin/matrix-notes/editor']" class="btn btn-success">
              <i class="fas fa-plus me-2"></i>Create New Tutorial
            </a>
            <a [routerLink]="['/tutorials']" class="btn btn-outline-info">
              <i class="fas fa-eye me-2"></i>View Public Tutorials
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>